{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    <h2 class="mb-4">Dettaglio Richiesta</h2>

    <div class="card shadow-sm">
        <div class="card-body">

            <!-- Header: ID, Priorità, Stato -->
            <div class="d-flex justify-content-between align-items-center mb-3">
                <strong>ID: {{ single_emergency.emergency_id }} | PRIORITÀ: {{ single_emergency.severity }}</strong>
                <span class="badge bg-secondary">
                    {% if single_emergency.resolved %}Risolta{% else %}In corso{% endif %}
                </span>
            </div>

            <!-- Informazioni principali -->
            <h5>Informazioni Utente</h5>
            <p>UUID: {{ single_emergency.user_uuid }}</p>

            <h5>Tipo emergenza</h5>
            <p>{{ single_emergency.emergency_type }}</p>

            <h5>Data creazione</h5>
            <p>{{ single_emergency.created_at.strftime('%d/%m/%Y %H:%M') }}</p>

            <h5>Posizione</h5>
            <p>Lat: {{ single_emergency.position[0] }}, Lng: {{ single_emergency.position[1] }}</p>

            <h5>Descrizione</h5>
            <p>{{ single_emergency.description }}</p>

            <!-- Foto -->
            {% if single_emergency.photo_b64 %}
            <h5>Foto</h5>
            <img src="data:image/jpeg;base64,{{ single_emergency.photo_b64 }}" alt="Foto emergenza" class="img-fluid">
            {% endif %}

            <!-- Dettagli JSON -->
            {% if single_emergency.details_json %}
            <h5 class="mt-3">Dettagli</h5>
            <div data-json='{{ single_emergency.details_json }}'></div>
            {% endif %}

            <!-- Pulsanti -->
            <!-- /send_emergency.html -->
            <a href="/edit/{{ single_emergency.emergency_id }}" class="btn btn-primary mt-3">Modifica richiesta</a>
            <a href="/my_emergencies" class="btn btn-secondary mt-3">Torna indietro</a>

        </div>
    </div>

</div>
{% endblock %}